<html><head><title>Playwright Test History</title>

    <style>
    .fail{color:red;}
    .pass{color:green;}
    .flaky{color:orange;}
    .multicore-only{background: #ffe0e0;}
    .singlepass{background: #e0ffe0;}
    .summary{font-weight:bold;}
    table{border-collapse:collapse; width:100%;}
    th,td{padding:4px 8px;}
    tr.selected{background:#eef;}
    tr:hover{background:#f5f5ff;}
    #search{margin:10px 0;}
    .err-details,.hist-details{display:none;white-space:pre-wrap;background:#fee;padding:8px;border:1px solid #f99;max-width:600px;overflow-x:auto;}
    .show{display:block;}
    .artifacts{font-size:0.9em;}
    .history{font-size:0.9em;color:#888;}
    .expand-btn{background:none;border:none;cursor:pointer;font-size:1em;vertical-align:middle;}
    .sticky{position:sticky;top:0;background:#fff;z-index:2;}
    .copy-btn{margin-left:6px;font-size:0.9em;cursor:pointer;}
    @media (max-width: 800px) {
      table, thead, tbody, th, td, tr { display: block; }
      th, td { width: 100%; box-sizing: border-box; }
    }
    </style>
    
</head><body>
<h1>Playwright Test History</h1>
<div class="summary">Total: 0 | Passing: 0 | Failing: 0 | Flaky: 0 | Multicore-only failures: 0</div>
<div>
<label>Status: <select id="statusFilter"><option value="">All</option><option value="pass">Passing</option><option value="fail">Failing</option><option value="flaky">Flaky</option><option value="multicore">Multicore-only</option></select></label>
<input type="text" id="search" placeholder="Search test name or file...">
</div>
<h2>All Tests</h2>
<div style="margin:8px 0;"><button onclick="expandAllErrs()">Expand all errors</button><button onclick="collapseAllErrs()">Collapse all errors</button><button onclick="expandAllHists()">Expand all history</button><button onclick="collapseAllHists()">Collapse all history</button></div>
<table border=1 id="testTable"><tr><th class="sticky" onclick="sortTable(0)">Test</th><th class="sticky" onclick="sortTable(1)">Status</th><th class="sticky" onclick="sortTable(2)">Single</th><th class="sticky" onclick="sortTable(3)">Multi</th><th class="sticky" onclick="sortTable(4)">Flaky</th><th class="sticky" onclick="sortTable(5)">Source</th><th class="sticky" onclick="sortTable(6)">Artifacts</th><th class="sticky" onclick="sortTable(7)">Error</th><th class="sticky" onclick="sortTable(8)">History</th></tr>
</table>
<script>
const table = document.getElementById('testTable');
const statusFilter = document.getElementById('statusFilter');
const searchBox = document.getElementById('search');
function filterTable() {
  const status = statusFilter.value;
  const search = searchBox.value.toLowerCase();
  for (let i = 1; i < table.rows.length; i++) {
    const row = table.rows[i];
    let show = true;
    if (status) {
      if (status === 'flaky' && !row.classList.contains('flaky')) show = false;
      if (status === 'fail' && !row.classList.contains('fail')) show = false;
      if (status === 'pass' && !row.classList.contains('pass')) show = false;
      if (status === 'multicore' && !row.classList.contains('multicore-only')) show = false;
    }
    if (search && !row.cells[0].textContent.toLowerCase().includes(search) && !row.cells[5].textContent.toLowerCase().includes(search)) {
      show = false;
    }
    row.style.display = show ? '' : 'none';
  }
}
statusFilter.oninput = searchBox.oninput = filterTable;
function toggleErr(idx, btn) {
  var d = document.getElementById('err'+idx);
  if (d) {
    d.classList.toggle('show');
    if (btn) {
      let expanded = d.classList.contains('show');
      btn.setAttribute('aria-expanded', expanded);
      btn.textContent = expanded ? '▼' : '▶';
    }
  }
}
function toggleHist(idx, btn) {
  var d = document.getElementById('hist'+idx);
  if (d) {
    d.classList.toggle('show');
    if (btn) {
      let expanded = d.classList.contains('show');
      btn.setAttribute('aria-expanded', expanded);
      btn.textContent = expanded ? '▼' : '▶';
    }
  }
}
function expandAllErrs() {
  let i = 0; while (true) {
    let d = document.getElementById('err'+i);
    let btn = document.querySelector('button[aria-controls="err'+i+'"]');
    if (!d) break;
    d.classList.add('show');
    if (btn) { btn.setAttribute('aria-expanded', true); btn.textContent = '▼'; }
    i++;
  }
}
function collapseAllErrs() {
  let i = 0; while (true) {
    let d = document.getElementById('err'+i);
    let btn = document.querySelector('button[aria-controls="err'+i+'"]');
    if (!d) break;
    d.classList.remove('show');
    if (btn) { btn.setAttribute('aria-expanded', false); btn.textContent = '▶'; }
    i++;
  }
}
function expandAllHists() {
  let i = 0; while (true) {
    let d = document.getElementById('hist'+i);
    let btn = document.querySelector('button[aria-controls="hist'+i+'"]');
    if (!d) break;
    d.classList.add('show');
    if (btn) { btn.setAttribute('aria-expanded', true); btn.textContent = '▼'; }
    i++;
  }
}
function collapseAllHists() {
  let i = 0; while (true) {
    let d = document.getElementById('hist'+i);
    let btn = document.querySelector('button[aria-controls="hist'+i+'"]');
    if (!d) break;
    d.classList.remove('show');
    if (btn) { btn.setAttribute('aria-expanded', false); btn.textContent = '▶'; }
    i++;
  }
}
function copyErr(idx, event) {
  event.stopPropagation();
  var d = document.getElementById('err'+idx);
  if (d) {
    let text = d.textContent.replace('Copy','').trim();
    navigator.clipboard.writeText(text);
    let btn = d.querySelector('.copy-btn');
    if (btn) {
      btn.textContent = 'Copied!';
      setTimeout(()=>{btn.textContent='Copy';}, 1200);
    }
  }
}
// Sorting
let sortDir = 1;
let lastSortCol = -1;
function sortTable(n) {
  let switching = true;
  let rows, i, x, y, shouldSwitch;
  while (switching) {
    switching = false;
    rows = table.rows;
    for (i = 1; i < (rows.length - 1); i++) {
      shouldSwitch = false;
      x = rows[i].cells[n].textContent.toLowerCase();
      y = rows[i + 1].cells[n].textContent.toLowerCase();
      if (n === lastSortCol) {
        if ((sortDir === 1 && x > y) || (sortDir === -1 && x < y)) {
          shouldSwitch = true;
          break;
        }
      } else {
        if (x > y) {
          shouldSwitch = true;
          break;
        }
      }
    }
    if (shouldSwitch) {
      rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
      switching = true;
    }
  }
  if (n === lastSortCol) {
    sortDir = -sortDir;
  } else {
    sortDir = 1;
    lastSortCol = n;
  }
}
</script>
</body></html>